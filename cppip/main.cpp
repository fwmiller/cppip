#include <stdio.h>
#include "cppip.h"

uint8_t pkt[] = { 0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08, 0x09, 0x0a, 0x0b, 0x08, 0x00,
                  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xc0, 0x0a, 0x20, 0x3f, 0xc0, 0x0a, 0x20, 0x3c,
                  0x01, 0x0a, 0x00, 0x3c, 0x00, 0x10, 0x00, 0x00 };

int main()
{
    printf("C++ Internet Protocols\r\n");

    bufdump(pkt, sizeof(struct eth_hdr));

    class eth eth;
    eth.set_buf(pkt);
    eth.dump();

    class ipv4 ip;
    ip.set_buf(eth.get_buf() + sizeof(struct eth_hdr));
    ip.dump();

    class udp udp;
    udp.set_buf(ip.get_buf() + sizeof(struct ipv4_hdr));
    udp.dump();
}